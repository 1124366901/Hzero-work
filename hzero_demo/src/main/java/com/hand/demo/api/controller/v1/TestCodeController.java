package com.hand.demo.api.controller.v1;import io.choerodon.core.iam.ResourceLevel;import io.choerodon.swagger.annotation.Permission;import io.swagger.annotations.ApiOperation;import org.hzero.boot.message.MessageClient;import org.hzero.boot.message.entity.Message;import org.hzero.boot.message.entity.Receiver;import org.hzero.boot.platform.code.builder.CodeRuleBuilder;import org.hzero.boot.platform.profile.ProfileClient;import org.hzero.core.base.BaseController;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.redis.connection.MessageListener;import org.springframework.web.bind.annotation.*;import java.util.Collections;import java.util.Map;@RestController("codeController.v1")@RequestMapping("/v1/code")public class TestCodeController extends BaseController {    @Autowired    private CodeRuleBuilder codeRuleBuilder;    @Autowired    private ProfileClient profileClient;    @Autowired    private MessageClient messageClient;    @ApiOperation(value = "制定接收人列表发送站内信息")    @Permission(level = ResourceLevel.SITE,permissionLogin = true)    @PostMapping("/test-sent-message")    public Message sendWebMessage(long tenantId, String messageTempleCode, long receiverMan,                                  Map<String,String> args){        Receiver receiver=new Receiver().setUserId(receiverMan).setTargetUserTenantId(receiverMan);        return messageClient.sendWebMessage(tenantId,messageTempleCode, Collections.singletonList(receiver),args);    }    @ApiOperation(value = "生成租户级编码规则（按照租户隔离）")    @Permission(level = ResourceLevel.SITE, permissionLogin = true)    @PostMapping("/code-rule")    public String generateCode(            Long tenantId,            String ruleCode,            String levelCode,            String levelValue,            Map<String, String> variableMap) {        return codeRuleBuilder.generateCode(tenantId, ruleCode, levelCode, levelValue, variableMap);    }    @ApiOperation(value = "维护测试")    @Permission(level = ResourceLevel.ORGANIZATION, permissionLogin = true)    @PostMapping("/respect")    public String getProfileValueByOptions(Long tenantId, Long userId, Long roleId, String profileName){        return profileClient.getProfileValueByOptions(tenantId, userId, roleId, profileName);    }}